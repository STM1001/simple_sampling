[{"name":"app.R","content":"library(shiny)\r\nlibrary(plotly)\r\n#library(rsconnect)\r\n#deployApp(\"path/to/shiny/app\")\r\n\r\n# Shiny app\r\nui <- fluidPage(\r\n  titlePanel(\"Random Sampling Visualization - STM1001 Students Example\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      helpText(\"Specify the population size\"),\r\n      numericInput(\"total_points\", \"Total number of data points (Population):\", value = 50, min = 10, max = 500, step = 10),\r\n      helpText(\"Select the number of individuals to sample (less than or equal to the population number)\"),\r\n      numericInput(\"n_sample\", \"Number of points to highlight (Sample):\", value = 5, min = 1, max = 50, step = 1),\r\n      actionButton(\"resample\", \"Resample\")\r\n    ),\r\n    mainPanel(\r\n      plotlyOutput(\"scatterPlot\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output) {\r\n  data <- reactive({\r\n    data.frame(\r\n      x = rnorm(input$total_points, 20, 1),\r\n      y = rnorm(input$total_points, 165, 10)\r\n    )\r\n  })\r\n  \r\n  random_sample <- reactive({\r\n    sample(1:input$total_points, input$n_sample)\r\n  })\r\n  \r\n  observeEvent(input$resample, {\r\n    random_sample()\r\n  })\r\n  \r\n  output$scatterPlot <- renderPlotly({\r\n    df <- data()\r\n    df$color <- ifelse(1:nrow(df) %in% random_sample(), \"highlighted\", \"normal\")\r\n    \r\n    plot_ly(df, x = ~x, y = ~y, type = \"scatter\", mode = \"markers\",\r\n            marker = list(size = 10, color = ~ifelse(color == \"highlighted\", \"red\", \"grey\")))  %>%\r\n      layout(title = \"Random Sampling Visualization\", xaxis = list(title = \"Age (years)\"),  yaxis = list(title = \"Height (cm)\"))\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
